{"name":"One Button Audio","key":"onebuttonaudio","version":"1.0.3","instructions":"A One Button Audio player","showatto":"0","showplayers":"1","requirecss":"","requirejs":"","shim":"","defaults":"size=80px,progress=007E88,background=333,font=fff,","amd":"1","body":"<audio id=\"@@AUTOID@@_audio\" controlList=\"noDownload\" class=\"poodll_onebuttonaudio nomediaplugin hide\" src=\"@@VIDEOURL@@\"></audio>\n<div id='@@AUTOID@@_container' class=\"poodll_onebuttonaudio_container\">\n<canvas id=\"@@AUTOID@@_canvas\" width=\"@@size@@\" height=\"@@size@@\" style=\"margin: 0 auto;\"></canvas>\n\t<button id='@@AUTOID@@_button' class=\"poodll_onebuttonaudio_button\" ><i class=\"fa fa-play\" aria-hidden=\"true\"></i></button>\n</div>","bodyend":"","script":"var player = $('#' + @@AUTOID@@ + '_audio'); \nvar button= $('#' + @@AUTOID@@ + '_button'); \nvar playing=false;\nvar canvas = document.getElementById(@@AUTOID@@ + '_canvas');\nvar context = canvas.getContext('2d');\nvar x = canvas.width / 2;\nvar y = canvas.height / 2;\nvar radius = 27;\nvar endPercent = 100;\nvar curPerc = 0;\nvar counterClockwise = false;\nvar circ = Math.PI * 2;\nvar quart = Math.PI / 2;\n//set up drawing\ncontext.lineWidth = 10;\ncontext.strokeStyle = '#' + @@progress@@;\ncontext.shadowOffsetX = 0;\ncontext.shadowOffsetY = 0;\ncontext.shadowBlur = 10;\n//context.shadowColor = '#fff';\n\n//to fetch current % of playback\nvar fetchCurrent= function(){\n    var currentTime = player.prop('currentTime');\n    var duration = player.prop('duration');\n    var current = currentTime/duration;\n    return current;\n}\n\nvar clear = function(){\n context.clearRect(0, 0, canvas.width, canvas.height);\n};\n\n//recursive draw arc\nvar draw = function() {\n if(!playing){return;}\n context.beginPath();\n context.arc(x, y, radius, -(quart), ((circ) * fetchCurrent()) - quart, false);\n context.stroke();\n  \t var drawFrame = requestAnimationFrame(draw);\n}\n\nvar doPlay = function(){\n  player.get(0).load();\n  var pp = player.get(0).play();\n  if(pp !== 'undefined'){\n   pp.then(function(){\n     playing=true;\n     draw();\n}).catch(function(e){\n       //do nothing\n    });//end of then catch\n}else{\n  playing=true;\n  draw();  \n}//endof if pp\n};//end of doplay\n\n\n//add button events\nbutton.click(function(){\nif($(this).hasClass('playing')){\n\t$(this).removeClass('playing');\n\t$(this).empty();\n\t$(this).append('<i class=\"fa fa-play\" aria-hidden=\"true\"></i>');\n        $( '.poodll_onebuttonaudio_button .fa' ).css( \"color\",'#'+@@font@@+'' );\n}else{\n\t$(this).addClass('playing');\n\t$(this).empty();\n\t$(this).append('<i class=\"fa fa-stop\" aria-hidden=\"true\"></i>');\n        $( '.poodll_onebuttonaudio_button .fa' ).css( \"color\",'#'+@@font@@+'' );\n}\n\n\nif(!player.prop('paused') && !player.prop('ended')){\n   //change button style \n    player.get(0).pause();\n    playing=false;\n    clear(); \n}else{\n //change button style\n   clear();\n  doPlay();\n}//end of if playerprop\n})\n\nplayer.on('ended',function(){\n  //change button style\n player.get(0).pause();\n playing=false;\n clear();\n if(button.hasClass('playing')){\n\t$(button).removeClass('playing');\n\t$(button).empty();\n\t$(button).append('<i class=\"fa fa-play\" aria-hidden=\"true\"></i>');\n        $( '.poodll_onebuttonaudio_button .fa' ).css( \"color\",'#'+@@font@@+'' );\n }\n})\n$( '.poodll_onebuttonaudio_container' ).css( \"background-color\",'#'+@@background@@+'' );\n$( '.poodll_onebuttonaudio_button .fa' ).css( \"color\",'#'+@@font@@+'' );","style":"","dataset":"","datasetvars":"","alternate":"","alternateend":""}